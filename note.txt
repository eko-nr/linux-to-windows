# ================= On windows powershell ================
Set-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server" -Name "fDenyTSConnections" -Value 0
Set-Service -Name TermService -StartupType Automatic
Start-Service -Name TermService

# Enable firewall
Enable-NetFirewallRule -DisplayGroup "Remote Desktop" -ErrorAction SilentlyContinue
netsh advfirewall firewall add rule name="Allow RDP TCP" dir=in action=allow protocol=TCP localport=3389
netsh advfirewall firewall add rule name="Allow RDP UDP" dir=in action=allow protocol=UDP localport=3389

Get-NetFirewallRule -DisplayGroup "Remote Desktop"

# User
net user rdpuser Random!23 /add
net localgroup "Remote Desktop Users" rdpuser /add

#Check RDP
netstat -ano | findstr :3389